<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Checklist</title>
  <style>
  </style>
  <script>
    function setup() {
      bind_list();
      bind_form();
      function bind_list() {
        var checklist = document.getElementById('checklist');
        checklist.addEventListener('click', function(event) {
          if( event.target.tagName === 'LI' ) {
            this.removeChild(event.target);
          }
        })
      }
      function bind_form() {
        var validator = {
          invalidTokens: /[^\w `\-=~!@#$%^&*()+[\]\\{}|;:'",./<>?]/,
          getInvalids: function(content) {
            return this.invalidTokens.exec(content);
          }
        }

        function clearMsg() {
          document.getElementById('warning-msg').innerHTML = '';
        }
        function displayMsg(message) {
          // Assuming that message is valid, non-malicious HTML fragment
          document.getElementById('warning-msg').innerHTML = message;
        }

        var form_new = document.getElementById('form_new');
        form_new.addEventListener('submit', function(e) {
          e.preventDefault();
          clearMsg();
          var contents = document.getElementById('new-item-content').value;
          var invalid = validator.getInvalids(contents);
          if( invalid ) { // invalid is not null
            var bad_char = invalid[0];
            displayMsg("Item content is invalid! The character '" +  bad_char + "' is not allowed!");
            return;
          }
          // Message was valid
          var newLi = document.createElement('li');
          newLi.appendChild(document.createTextNode(contents));
          document.getElementById('checklist').appendChild(newLi);
          this.reset();
        }, false);
        form_new.addEventListener('blur', function() {
          clearMsg();
        }, true); // Final argument true in order to allow for event delegation
      }
    }
    window.addEventListener('load', setup, false);
  </script>
</head>
<body>
  <div>
    <h1 id="main-heading">Checklist</h1>
  </div>
  <div>
    <ul id="checklist">
    </ul>
  </div>
  <form id="form_new">
    <input id="new-item-content" type="text"/>
    <p id="warning-msg"></p>
    <button id="submit" type="submit">Make New Item</button>
  </form>
</body>
</html>
